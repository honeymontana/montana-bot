# Montana Bot - Примеры настройки cron для автоматической синхронизации
#
# Скопируйте нужные строки в ваш crontab:
#   crontab -e
#
# Формат cron:
#   минута час день месяц день_недели команда
#   *      *   *    *     *           команда
#
# Примеры времени:
#   0 3 * * *     - Каждый день в 3:00
#   0 */6 * * *   - Каждые 6 часов
#   */30 * * * *  - Каждые 30 минут
#   0 0 * * 0     - Каждое воскресенье в полночь

# =============================================================================
# АВТОМАТИЧЕСКАЯ СИНХРОНИЗАЦИЯ ДАННЫХ
# =============================================================================

# Синхронизация каждый день в 3:00 утра (рекомендуется)
0 3 * * * cd /Users/nick/montana-tg-bot && /usr/bin/python3 scripts/auto_sync.py >> /tmp/montana-sync.log 2>&1

# Альтернатива: Синхронизация каждые 6 часов
# 0 */6 * * * cd /Users/nick/montana-tg-bot && /usr/bin/python3 scripts/auto_sync.py >> /tmp/montana-sync.log 2>&1

# Альтернатива: Синхронизация каждый час
# 0 * * * * cd /Users/nick/montana-tg-bot && /usr/bin/python3 scripts/auto_sync.py >> /tmp/montana-sync.log 2>&1

# =============================================================================
# АВТОМАТИЧЕСКОЕ ОБНОВЛЕНИЕ МЕТРИК (опционально)
# =============================================================================

# Обновить метрики каждые 15 минут
# */15 * * * * curl -s -X POST -H "X-API-Key: montana-secret-key-2026" http://localhost:3000/api/bot/sync > /dev/null 2>&1

# =============================================================================
# ОЧИСТКА СТАРЫХ ЛОГОВ
# =============================================================================

# Очищать логи старше 30 дней каждое воскресенье
# 0 2 * * 0 find /tmp -name "montana-*.log" -mtime +30 -delete

# =============================================================================
# РЕЗЕРВНОЕ КОПИРОВАНИЕ БД
# =============================================================================

# Бэкап БД каждый день в 2:00
# 0 2 * * * docker-compose exec -T postgres pg_dump -U montana montana_bot | gzip > /backups/montana_$(date +\%Y\%m\%d).sql.gz

# Удалить бэкапы старше 7 дней
# 0 4 * * * find /backups -name "montana_*.sql.gz" -mtime +7 -delete

# =============================================================================
# МОНИТОРИНГ
# =============================================================================

# Проверить здоровье дашборда каждые 5 минут
# */5 * * * * curl -sf http://localhost:3000/api/bot/status > /dev/null || echo "Dashboard is down!" | mail -s "Montana Dashboard Alert" admin@example.com

# =============================================================================
# ПОЛЕЗНЫЕ ПЕРЕМЕННЫЕ ОКРУЖЕНИЯ
# =============================================================================

# Если нужно задать переменные окружения для cron:
# DASHBOARD_URL=http://localhost:3000
# DASHBOARD_API_KEY=montana-secret-key-2026
# TELEGRAM_EXPORT_PATH=/path/to/export/result.json
# SYNC_LOG_FILE=/var/log/montana-sync.log

# Пример с переменными:
# 0 3 * * * DASHBOARD_URL=http://localhost:3000 DASHBOARD_API_KEY=montana-secret-key-2026 cd /Users/nick/montana-tg-bot && /usr/bin/python3 scripts/auto_sync.py >> /tmp/montana-sync.log 2>&1
